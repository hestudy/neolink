# Story 1.1: 项目基础设施搭建

## Status

Approved

## Story

**作为一个** 开发者，
**我想要** 建立完整的项目基础设施，
**以便** 能够开始开发和部署 NeoLink 系统。

## Acceptance Criteria

1. Monorepo 结构已创建，包含 apps/web、apps/api、packages/shared 等目录
2. TypeScript 配置已设置，支持严格模式和路径映射
3. pnpm 工作空间配置正确，支持包间依赖管理
4. ESLint 和 Prettier 配置已设置，确保代码质量一致性
5. GitHub 仓库已创建，包含 README、贡献指南和许可证
6. GitHub Actions CI/CD 流水线已配置，支持自动测试和构建
7. Docker 和 docker-compose 配置已创建，支持本地开发环境
8. 基础的健康检查端点已实现并可访问

## Tasks / Subtasks

- [ ] 创建 Monorepo 结构 (AC: 1)

  - [ ] 创建 apps/web 目录（Next.js 前端应用）
  - [ ] 创建 apps/api 目录（Hono.js 后端 API）
  - [ ] 创建 packages/shared 目录（共享类型和工具）
  - [ ] 创建 packages/database 目录（数据库 schema 和迁移）
  - [ ] 创建 packages/ai 目录（AI 处理模块）
  - [ ] 创建 packages/ui 目录（shadcn/ui 组件扩展）
  - [ ] 创建 packages/config 目录（共享配置）

- [ ] 配置 TypeScript 和构建工具 (AC: 2, 3)

  - [ ] 设置根级 TypeScript 配置，启用严格模式
  - [ ] 配置路径映射支持包间引用
  - [ ] 设置 pnpm 工作空间配置文件
  - [ ] 配置 Turborepo 用于构建优化
  - [ ] 设置各包的 package.json 和依赖关系

- [ ] 配置代码质量工具 (AC: 4)

  - [ ] 设置 ESLint 配置，包含 TypeScript 和 React 规则
  - [ ] 配置 Prettier 代码格式化
  - [ ] 设置 pre-commit hooks 确保代码质量
  - [ ] 配置 VS Code 工作空间设置

- [ ] 设置版本控制和文档 (AC: 5)

  - [ ] 创建详细的 README.md 文件
  - [ ] 编写贡献指南 CONTRIBUTING.md
  - [ ] 添加 MIT 许可证文件
  - [ ] 设置 .gitignore 文件

- [ ] 配置 CI/CD 流水线 (AC: 6)

  - [ ] 创建 GitHub Actions 工作流配置
  - [ ] 设置自动化测试流水线
  - [ ] 配置构建和类型检查
  - [ ] 设置代码质量检查

- [ ] 配置 Docker 开发环境 (AC: 7)

  - [ ] 创建多阶段 Dockerfile
  - [ ] 配置 docker-compose.yml 开发环境
  - [ ] 设置 PostgreSQL 和 Redis 服务
  - [ ] 配置环境变量模板

- [ ] 实现基础健康检查 (AC: 8)
  - [ ] 创建基础 Hono.js 服务器
  - [ ] 实现 /health 端点
  - [ ] 添加数据库连接检查
  - [ ] 配置服务启动脚本

## Dev Notes

### 项目结构信息

基于架构文档，项目采用 Monorepo + Turborepo 结构：
[Source: docs/architecture.md#仓库结构]

```
neolink/
├── apps/
│   ├── web/          # Next.js前端应用
│   └── api/          # Hono.js后端API
├── packages/
│   ├── shared/       # 共享类型和工具
│   ├── database/     # 数据库schema和迁移
│   ├── ai/           # AI处理模块
│   ├── ui/           # shadcn/ui组件扩展
│   └── config/       # 共享配置（ESLint、TypeScript、Jest）
├── turbo.json        # Turborepo配置
├── package.json      # 根package.json
└── pnpm-workspace.yaml
```

### 技术栈要求

[Source: docs/architecture.md#技术概览]

- **构建工具**: Turborepo + pnpm（高性能构建和缓存）
- **前端**: Next.js 14+ (App Router) + TypeScript 5.0+
- **后端**: Hono.js + oRPC + TypeScript 5.0+
- **运行时**: Node.js 20+ LTS
- **容器化**: Docker + Docker Compose

### 代码质量标准

[Source: docs/prd.md#技术假设和约束]

- TypeScript 严格模式启用
- ESLint + Prettier 代码质量保证
- 路径映射支持包间依赖
- pre-commit hooks 确保提交质量

### Docker 配置要求

[Source: docs/architecture.md#容器化架构]

- 基础镜像：node:20-alpine
- 多阶段构建优化镜像大小
- 健康检查端点配置
- 环境变量管理

### Testing

#### 测试框架和工具

[Source: docs/prd.md#测试要求]

- **测试工具**: Vitest + Testing Library + Playwright
- **覆盖率要求**: 单元测试>80%，关键业务逻辑>95%
- **测试类型**: Unit + Integration 测试金字塔

#### 测试文件位置

- 单元测试：与源文件同目录，使用 `.test.ts` 后缀
- 集成测试：`tests/integration/` 目录
- 端到端测试：`tests/e2e/` 目录

#### 测试标准

- 所有公共 API 必须有测试覆盖
- 关键业务逻辑必须有完整测试
- 测试必须独立运行，不依赖外部服务
- 使用 TypeScript 编写测试，确保类型安全

## Change Log

| Date       | Version | Description                 | Author |
| ---------- | ------- | --------------------------- | ------ |
| 2025-01-15 | 1.0     | 初始故事创建，基于 Epic 1.1 | Bob    |

## Dev Agent Record

_此部分将由开发代理在实施过程中填充_

### Agent Model Used

_待填充_

### Debug Log References

_待填充_

### Completion Notes List

_待填充_

### File List

_待填充_

## QA Results

_此部分将由 QA 代理在完成故事实施的 QA 审查后填充_
